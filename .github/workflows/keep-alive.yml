# 更新后的工作流 - 三重保险
name: Keep Alive2.0

on:
  schedule:
    - cron: '0 */4 * * *'  # 每 4 小时
  workflow_dispatch:

jobs:
  wake-space:
    runs-on: ubuntu-latest
    timeout-minutes: 15
    
    steps:
      - uses: actions/checkout@v3
      
      - uses: actions/setup-python@v4
        with:
          python-version: '3.10'
      
      - name: Install all dependencies
        run: |
          pip install gradio_client requests
      
      - name: Method 1 - Gradio Client (最可靠)
        env:
          SPACE_URL: ${{ secrets.SPACE_URL }}
        run: python wake_space.py
        continue-on-error: true
      
      - name: Method 2 - Browser Simulation
        if: always()
        env:
          SPACE_URL: ${{ secrets.SPACE_URL }}
        run: python browser_wake.py
        continue-on-error: true
      
      - name: Method 3 - Simple HTTP Ping
        if: always()
        env:
          SPACE_URL: ${{ secrets.SPACE_URL }}
        run: python ping_space.py
        continue-on-error: true
      
      - name: Summary
        if: always()
        run: |
          echo "✅ 三种保活方法均已尝试"
          echo "⏰ 完成时间: $(date)"
